From 8f693c7ac6f7749e14693dc1b2ae705defec1921 Mon Sep 17 00:00:00 2001
From: Tom Gundersen <teg@jklm.no>
Date: Tue, 6 May 2014 15:53:33 +0200
Subject: [PATCH] Enable biosdevname by default only on Dell servers

---
 biosdevname.rules.in | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/biosdevname.rules.in b/biosdevname.rules.in
index 0a32aa5..52aaea5 100644
--- a/biosdevname.rules.in
+++ b/biosdevname.rules.in
@@ -4,6 +4,9 @@ NAME=="?*",       GOTO="netdevicename_end"
 ATTR{type}!="1",  GOTO="netdevicename_end"
 ENV{DEVTYPE}=="?*", GOTO="netdevicename_end"
 
+# whitelist all Dell systems
+ATTR{[dmi/id]sys_vendor}=="Dell*", ENV{UDEV_BIOSDEVNAME}="1"
+
 # kernel command line "biosdevname={0|1}" can turn off/on biosdevname
 IMPORT{cmdline}="biosdevname"
 ENV{biosdevname}=="?*", ENV{UDEV_BIOSDEVNAME}="$env{biosdevname}"
@@ -12,13 +15,13 @@ ENV{biosdevname}=="?*", ENV{UDEV_BIOSDEVNAME}="$env{biosdevname}"
 ENV{UDEV_BIOSDEVNAME}=="0", GOTO="netdevicename_end"
 ENV{UDEV_BIOSDEVNAME}=="1", GOTO="netdevicename_start"
 
-# uncomment the next line for biosdevname to be off by default
-# GOTO="netdevicename_end"
+# off by default
+GOTO="netdevicename_end"
 
 LABEL="netdevicename_start"
 
 # using NAME= instead of setting INTERFACE_NAME, so that persistent
 # names aren't generated for these devices, they are "named" on each boot.
-SUBSYSTEMS=="pci", PROGRAM="/sbin/biosdevname --policy physical -i %k", NAME="%c",  OPTIONS+="string_escape=replace"
+SUBSYSTEMS=="pci", PROGRAM="/sbin/biosdevname --smbios 2.6 --nopirq --policy physical -i %k", NAME="%c",  OPTIONS+="string_escape=replace"
 
 LABEL="netdevicename_end"
-- 
1.9.0

